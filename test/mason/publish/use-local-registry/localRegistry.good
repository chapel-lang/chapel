+++ dirname $CHPL_HOME/test/mason/publish/use-local-registry/localRegistry.masontest
++ cd $CHPL_HOME/test/mason/publish/use-local-registry
++ pwd
+ CWD=$CHPL_HOME/test/mason/publish/use-local-registry
+ REG=$CHPL_HOME/test/mason/publish/use-local-registry/local-reg
+ cd myDep
+ git init -b main
Initialized empty Git repository in $CHPL_HOME/test/mason/publish/use-local-registry/myDep/.git/
+ git add .
+ git commit -m 'initial commit'
+ mason publish --create-registry $CHPL_HOME/test/mason/publish/use-local-registry/local-reg
Initialized local registry at $CHPL_HOME/test/mason/publish/use-local-registry/local-reg
Add this registry to MASON_REGISTRY environment variable to include it in search path:
   export MASON_REGISTRY="mason-registry|https://github.com/chapel-lang/mason-registry,local-reg|$CHPL_HOME/test/mason/publish/use-local-registry/local-reg"
+ mason publish --create-registry $CHPL_HOME/test/mason/publish/use-local-registry/local-reg
Registry already exists at $CHPL_HOME/test/mason/publish/use-local-registry/local-reg
+ echo 'error as expected: 1'
error as expected: 1
+ mason publish $CHPL_HOME/test/mason/publish/use-local-registry/local-reg
Successfully published package to $CHPL_HOME/test/mason/publish/use-local-registry/local-reg
+ mason publish $CHPL_HOME/test/mason/publish/use-local-registry/local-reg
A package with that name and version number already exists in the Bricks.
+ export 'MASON_REGISTRY=my-local-registry|$CHPL_HOME/test/mason/publish/use-local-registry/local-reg'
+ MASON_REGISTRY='my-local-registry|$CHPL_HOME/test/mason/publish/use-local-registry/local-reg'
+ mason search
Updating my-local-registry
myDep (0.1.0)
+ cd ../myPackage
+ mason build
Updating my-local-registry
Downloading dependency: myDep-0.1.0
Compiling [debug] target: myPackage
Build Successful

+ mason run
got strings: (set, set)
got magic: 17
+ mason test
Updating my-local-registry

----------------------------------------------------------------------
Ran 2 tests in n seconds

OK (passed = 2 )
+ mason run --example Ex.chpl --build
Updating my-local-registry
got strings: (set, set)
got magic: 17
+ cd ..
+ mason new myNewPackage
Created new application project: myNewPackage
+ cd myNewPackage
+ mason add myDep@0.1.0
Adding Mason dependency myDep version 0.1.0
+ echo 'module myNewPackage { import myDep; proc main() { writeln("got strings: ", myDep.getStrings()); } }'
+ mason run --build
Updating my-local-registry
Compiling [debug] target: myNewPackage
Build Successful

got strings: (set, set)
