This is Richard's original code which has some problems, so I've marked
it as a notest.
