This version does not function correctly with the recent arrays changes
and is mainly of historical value, so it will not be tested.
