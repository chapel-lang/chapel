This is a snapshot approximating the code we submitted to HPCC06
